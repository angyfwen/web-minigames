<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>alis' web minigames</title>
<meta name="description" content="jojoverse vibes ‚Ä¢ play the collection" />
<link rel="icon" href="/favicon.ico" />
<!-- Auto-generated social preview (no upload needed) -->
<meta property="og:image" content="https://image.thum.io/get/width/1200/crop/630/https://angyfwen.github.io/web-minigames/" />

<!-- Typography -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">

<style>
  :root {
    /* Core Background (Always Dark for GIFs) */
    --bg: #050507;
    
    /* Default Dark Mode Colors */
    --text-main: #f0f0f5;     /* Global text (footer) */
    --text-muted: #94a3b8;    /* Global muted (footer) */
    
    /* Card/UI Specific Colors (Swappable) */
    --card-text: #f0f0f5;
    --card-muted: #94a3b8;
    
    /* Glass Effect Variables */
    --glass-surface: rgba(20, 20, 25, 0.65);
    --glass-border: rgba(255, 255, 255, 0.08);
    --glass-highlight: rgba(255, 255, 255, 0.15);
    --blur-amt: 16px;

    /* Accents */
    --primary: #8b5cf6;
    --accent-gradient: linear-gradient(135deg, #ff6b6b, #ffd36b);
    --button-gradient: linear-gradient(90deg, #ff6b6b, #ffd36b, #4ade80, #60a5fa, #a78bfa);
    
    /* Shadows */
    --glow: 0 0 20px rgba(139, 92, 246, 0.15);
    --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  }

  /* Hybrid Light Mode: Light Cards on Dark BG */
  :root.light {
    /* Background stays dark so we see the GIF! */
    --bg: #050507;
    
    /* Text on the background (footer) stays light */
    --text-main: #f0f0f5;
    --text-muted: #94a3b8;

    /* BUT Cards turn White */
    --card-text: #1e293b;     /* Dark text for white cards */
    --card-muted: #64748b;    /* Muted text for white cards */
    
    --glass-surface: rgba(255, 255, 255, 0.92);
    --glass-border: rgba(0, 0, 0, 0.1); /* Slightly darker border for white cards */
    --glass-highlight: rgba(255, 255, 255, 1);
    
    --glow: 0 0 20px rgba(255, 255, 255, 0.4);
    --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  }

  * { box-sizing: border-box; }
  
  body {
    background: var(--bg);
    color: var(--text-main);
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: background 0.4s ease, color 0.4s ease;
    overflow-x: hidden;
  }

  /* Chaos Mode (triggered by search) */
  body.chaos-mode {
    animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both infinite;
    filter: invert(1) hue-rotate(180deg);
  }
  @keyframes shake {
    10%, 90% { transform: translate3d(-1px, 0, 0); }
    20%, 80% { transform: translate3d(2px, 0, 0); }
    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
    40%, 60% { transform: translate3d(4px, 0, 0); }
  }

  /* Rainbow Border Animations */
  @keyframes rainbow-border-glow {
    0% { border-color: #ff6b6b; box-shadow: 0 0 15px rgba(255,107,107,0.3); }
    20% { border-color: #ffd36b; box-shadow: 0 0 15px rgba(255,211,107,0.3); }
    40% { border-color: #4ade80; box-shadow: 0 0 15px rgba(74,222,128,0.3); }
    60% { border-color: #60a5fa; box-shadow: 0 0 15px rgba(96,165,250,0.3); }
    80% { border-color: #a78bfa; box-shadow: 0 0 15px rgba(167,139,250,0.3); }
    100% { border-color: #ff6b6b; box-shadow: 0 0 15px rgba(255,107,107,0.3); }
  }

  @keyframes rainbow-border-text-glow {
    0% { border-color: #ff6b6b; color: #ff6b6b; box-shadow: inset 0 0 10px rgba(255,107,107,0.2); }
    20% { border-color: #ffd36b; color: #ffd36b; box-shadow: inset 0 0 10px rgba(255,211,107,0.2); }
    40% { border-color: #4ade80; color: #4ade80; box-shadow: inset 0 0 10px rgba(74,222,128,0.2); }
    60% { border-color: #60a5fa; color: #60a5fa; box-shadow: inset 0 0 10px rgba(96,165,250,0.2); }
    80% { border-color: #a78bfa; color: #a78bfa; box-shadow: inset 0 0 10px rgba(167,139,250,0.2); }
    100% { border-color: #ff6b6b; color: #ff6b6b; box-shadow: inset 0 0 10px rgba(255,107,107,0.2); }
  }

  /* Menacing Mouse Trail */
  .menacing-trail {
    position: fixed;
    pointer-events: none;
    color: #a78bfa; /* Jojo Purple */
    font-weight: 900;
    font-family: 'Space Grotesk', sans-serif;
    font-size: 20px;
    animation: float-away 1s forwards;
    z-index: 9999;
    text-shadow: 2px 2px 0px rgba(0,0,0,0.5);
  }
  @keyframes float-away {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(-40px) scale(1.5); opacity: 0; }
  }

  /* Loading Overlay */
  #loader {
    position: fixed; inset: 0; z-index: 10000;
    background: #050507;
    display: flex; flex-direction: column; gap: 16px;
    align-items: center; justify-content: center;
    transition: opacity 0.5s ease;
    cursor: pointer; /* Show it's clickable */
    padding: 20px; /* Added padding for mobile */
    text-align: center; /* Center text on mobile */
  }
  .loader-text { 
    font-family: 'Space Grotesk', sans-serif; 
    font-size: clamp(20px, 5vw, 24px); /* Responsive font size */
    font-weight: 700;
    background: linear-gradient(90deg, #ff6b6b, #ffd36b, #4ade80, #60a5fa, #a78bfa);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    animation: pulse 1s infinite alternate;
    line-height: 1.4;
  }
  /* Mobile break utility */
  .mobile-break { display: none; }
  
  .loader-subtext {
    font-family: 'Inter', sans-serif;
    color: var(--text-muted);
    font-size: 14px;
    opacity: 0.8;
    animation: pulse 2s infinite alternate-reverse;
    max-width: 90%;
  }
  @keyframes pulse { from { opacity: 0.6; transform: scale(0.98); } to { opacity: 1; transform: scale(1.02); } }

  /* Toast Notification */
  .toast {
    position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(20px);
    background: rgba(15, 17, 20, 0.95); 
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #f0f0f5; padding: 12px 24px; border-radius: 50px;
    font-family: 'Space Grotesk', sans-serif; font-size: 14px; font-weight: 600;
    box-shadow: 0 10px 40px rgba(0,0,0,0.6);
    z-index: 10001; opacity: 0; pointer-events: none;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex; align-items: center; gap: 8px;
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  /* Custom Scrollbar */
  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgba(155, 155, 155, 0.3); border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(155, 155, 155, 0.5); }

  /* Background Handling */
  #bg-wrap { position: fixed; inset: 0; z-index: -1; overflow: hidden; pointer-events: none; }
  #bg-image { 
    position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; 
    /* Increased opacity to 0.4 so it's more visible */
    opacity: 0.4; 
    mix-blend-mode: screen; 
    /* Slower, smoother transition for the fade effect */
    transition: opacity 0.6s ease-in-out; 
  }
  
  #bg-svg { 
    position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; 
    opacity: 0.1; mask-image: radial-gradient(circle, transparent 30%, black 100%); 
  }
  .gogo {
    font-family: 'Space Grotesk', sans-serif;
    font-weight: 900; font-size: 20vh; line-height: 0.8; color: transparent;
    -webkit-text-stroke: 2px currentColor; transform: rotate(-8deg);
    opacity: 0.5; animation: sway 20s ease-in-out infinite alternate;
  }
  @keyframes sway { from { transform: translateX(-5%) rotate(-8deg); } to { transform: translateX(5%) rotate(-4deg); } }

  /* Layout Container */
  .wrap {
    width: 100%; max-width: 1140px; padding: 20px; z-index: 2;
    display: flex; flex-direction: column; gap: 24px;
  }

  /* Header */
  header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 24px; border-radius: 24px;
    background: var(--glass-surface);
    backdrop-filter: blur(var(--blur-amt));
    -webkit-backdrop-filter: blur(var(--blur-amt));
    border: 1px solid var(--glass-border);
    box-shadow: var(--card-shadow);
    position: relative; overflow: hidden;
    color: var(--card-text);
  }
  /* Decorative gradient line on left of header */
  header::before {
    content:''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px;
    background: var(--accent-gradient);
  }

  .header-left { display: flex; align-items: center; gap: 16px; }
  .pfp { 
    width: 58px; height: 58px; border-radius: 50%; object-fit: cover; 
    border: 2px solid rgba(255,255,255,0.1); 
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    flex-shrink: 0; /* Prevents squishing on mobile */
  }
  .pfp:hover { transform: scale(1.1) rotate(5deg); border-color: #ff6b6b; }

  /* Flex Container for Title and Github Link */
  .title-row {
    display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
  }
  
  /* Header Actions (Buttons) */
  .header-actions {
    display: flex; gap: 12px; align-items: center;
  }

  header h1 {
    margin: 0; font-family: 'Space Grotesk', sans-serif; font-size: 28px; 
    letter-spacing: -1px; background: var(--accent-gradient); 
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  }
  
  .status-text { margin: 2px 0 0; color: var(--card-muted); font-size: 13px; font-weight: 500; }
  
  .github-link {
    display: flex; align-items: center; gap: 5px;
    color: var(--card-muted); font-size: 13px; font-weight: 600;
    text-decoration: none; transition: all 0.2s;
    background: rgba(255,255,255,0.05); padding: 4px 10px; border-radius: 20px;
    border: 1px solid transparent;
  }
  .github-link:hover { 
    color: #fff; background: rgba(255,255,255,0.1); 
    border-color: rgba(255,255,255,0.1);
    transform: translateY(-1px);
  }
  :root.light .github-link:hover { color: #000; background: rgba(0,0,0,0.05); border-color: rgba(0,0,0,0.1); }

  /* Controls Section */
  .controls { 
    display: flex; 
    flex-direction: column; 
    gap: 12px; /* reduced space */
    flex-wrap: wrap; 
  }
  .controls-row { display: flex; gap: 16px; flex-wrap: wrap; }

  .search-wrap {
    flex: 1; min-width: 200px; position: relative;
    background: var(--glass-surface); border-radius: 16px;
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(10px);
    transition: border-color 0.2s, box-shadow 0.2s;
    color: var(--card-text);
  }
  .search-wrap:focus-within {
    animation: rainbow-border-glow 4s linear infinite;
  }
  .search-wrap input {
    width: 100%; background: transparent; border: 0; outline: 0;
    color: inherit; font-family: 'Space Grotesk', sans-serif; font-weight: 600;
    padding: 16px 16px 16px 48px; font-size: 16px;
  }
  .search-icon {
    position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
    color: var(--card-muted); pointer-events: none;
  }

  /* Game Compatibility Warning */
  .comp-warning {
    font-size: 14px;
    font-weight: 600;
    text-align: center;
    background: linear-gradient(90deg, #ff6b6b, #ffd36b, #4ade80, #60a5fa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    padding: 0; 
    margin: 16px auto 10px; /* Added 16px top margin for spacing */
    max-width: 80%; /* Constrain width */
  }


  /* Emoji Presets */
  .preset-row { display: flex; gap: 10px; }
  .preset {
    width: 52px; height: 52px; border-radius: 14px; border: 0; cursor: pointer;
    font-size: 24px; transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    background: var(--glass-surface); border: 1px solid var(--glass-border);
    backdrop-filter: blur(4px); box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    color: var(--card-text);
  }
  .preset:hover { transform: translateY(-4px) scale(1.1); background: var(--glass-highlight); }
  .preset:active { transform: scale(0.95); }
  
  /* Mode Toggle & Music Toggle */
  .preset.active { 
    animation: rainbow-border-text-glow 4s linear infinite;
  }
  
  /* Grid */
  .grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
  }

  /* Cards */
  .card {
    background: var(--glass-surface);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(var(--blur-amt));
    border-radius: 20px; padding: 16px;
    display: flex; flex-direction: column; gap: 16px;
    transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s;
    position: relative; overflow: hidden;
    opacity: 0; animation: fadeUp 0.6s forwards; /* Animated entrance handled by JS delay */
    color: var(--card-text);
  }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.4), inset 0 0 0 1px rgba(255,255,255,0.1);
    border-color: rgba(255,255,255,0.2);
  }
  :root.light .card:hover { box-shadow: 0 20px 40px rgba(0,0,0,0.1); }

  /* Card Header */
  .top { display: flex; align-items: center; gap: 12px; }
  .icon-box {
    width: 48px; height: 48px; border-radius: 12px;
    background: linear-gradient(180deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
    display: flex; align-items: center; justify-content: center;
    border: 1px solid var(--glass-border); 
    color: var(--card-text);
  }
  .icon-box svg { width: 26px; height: 26px; }

  .card-info h3 { margin: 0; font-family: 'Space Grotesk', sans-serif; font-size: 18px; letter-spacing: -0.5px; color: var(--card-text); }
  .card-info p { margin: 2px 0 0; color: var(--card-muted); font-size: 13px; }

  /* Thumbnail */
  .thumb-wrap {
    height: 120px; border-radius: 12px; overflow: hidden;
    background: rgba(0,0,0,0.2); position: relative;
    border: 1px solid var(--glass-border);
  }
  .thumb-wrap img {
    width: 100%; height: 100%; object-fit: cover;
    transition: transform 0.5s ease;
  }
  .card:hover .thumb-wrap img { transform: scale(1.08); }
  .fallback { 
    height: 100%; display: flex; flex-direction: column; 
    align-items: center; justify-content: center; color: var(--card-muted); gap: 8px;
    background: radial-gradient(circle at center, rgba(255,255,255,0.05), transparent);
  }

  /* Actions Footer */
  .actions { display: flex; justify-content: space-between; align-items: center; margin-top: auto; padding-top: 4px; }
  
  .play-btn {
    padding: 10px 24px; border-radius: 12px; border: 0;
    font-family: 'Space Grotesk', sans-serif; font-weight: 700; font-size: 14px;
    color: #000; text-decoration: none; cursor: pointer;
    background: var(--button-gradient); background-size: 300% 100%;
    animation: gradientMove 4s ease infinite;
    box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    transition: transform 0.2s, box-shadow 0.2s;
  }
  @keyframes gradientMove { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
  
  .play-btn:hover { transform: scale(1.05); box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5); }
  .play-btn:active { transform: scale(0.95); }

  .secondary-actions { display: flex; gap: 8px; }
  .icon-btn {
    width: 36px; height: 36px; border-radius: 10px; border: 1px solid var(--glass-border);
    background: transparent; color: var(--card-muted); cursor: pointer;
    display: grid; place-items: center; transition: all 0.2s;
  }
  .icon-btn:hover { background: rgba(255,255,255,0.1); color: var(--card-text); }
  .icon-btn.hearted { color: #ff6b6b; border-color: rgba(255, 107, 107, 0.3); background: rgba(255, 107, 107, 0.1); }

  /* Modal */
  .modal {
    position: fixed; inset: 0; z-index: 100;
    background: rgba(0,0,0,0.8); backdrop-filter: blur(8px);
    display: none; align-items: center; justify-content: center; padding: 20px;
    opacity: 0; transition: opacity 0.3s;
  }
  .modal.open { display: flex; opacity: 1; }
  
  .modal-panel {
    width: 100%; max-width: 1000px; background: #1a1a1f;
    border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
    box-shadow: 0 50px 100px rgba(0,0,0,0.8); overflow: hidden;
    display: flex; flex-direction: column;
    transform: scale(0.95); transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  .modal.open .modal-panel { transform: scale(1); }

  .modal-header {
    padding: 16px 20px; display: flex; justify-content: space-between; align-items: center;
    background: rgba(255,255,255,0.03); border-bottom: 1px solid rgba(255,255,255,0.05);
  }
  .modal-title { font-family: 'Space Grotesk', sans-serif; font-weight: 700; font-size: 18px; color: #f0f0f5; }
  .close-btn { 
    background: transparent; border: 0; color: #94a3b8; 
    cursor: pointer; font-size: 24px; line-height: 1; 
  }
  .close-btn:hover { color: #f0f0f5; }
  
  .modal iframe { width: 100%; height: 70vh; border: 0; background: #000; }
  
  /* External Link Button */
  .external-link-btn {
    color: var(--primary);
    text-decoration: none;
    font-size: 13px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 8px;
    background: rgba(139, 92, 246, 0.1);
    border: 1px solid rgba(139, 92, 246, 0.2);
    transition: all 0.2s ease;
  }
  .external-link-btn:hover {
    background: rgba(139, 92, 246, 0.2);
    transform: translateY(-1px);
  }

  /* Footer */
  footer { 
    margin-top: 40px; text-align: center; color: var(--text-muted); 
    font-size: 12px; padding-bottom: 40px; opacity: 0.6;
  }

  /* Responsive */
  @media (max-width: 600px) {
    .controls { flex-direction: column; }
    .search-wrap { width: 100%; }
    .preset-row { width: 100%; justify-content: space-between; }
    .preset { width: 48px; height: 48px; }
    .card { padding: 12px; }
    .modal iframe { height: 60vh; }
    .mobile-break { display: block; } /* Show break on mobile */
    
    /* Mobile Header Layout */
    header {
      align-items: flex-start; /* Align to top */
    }
    
    .title-row {
      flex-direction: column; /* Stack Title and Github Link */
      align-items: flex-start;
      gap: 6px;
    }
    
    .header-actions {
      flex-direction: column; /* Stack Buttons Vertical */
      gap: 8px;
      margin-top: 4px;
    }
    
    .status-text {
      margin-top: 8px; /* Give description some breathing room from the link */
    }
    
    /* Adjust font size slightly for mobile title */
    header h1 { font-size: 22px; }
    
    .pfp { width: 50px; height: 50px; }
  }
</style>
</head>
<body>
  
  <div id="loader">
    <div class="loader-text">loading chaos...</div>
    <div id="loader-subtext" class="loader-subtext"></div>
  </div>

  <div id="toast-container"></div> <!-- Container for toasts -->

  <div id="bg-wrap" aria-hidden="true">
    <img id="bg-image" alt="" />
    <div id="bg-svg"><div class="gogo">GOGOGOGO</div></div>
  </div>

  <div class="wrap">
    
    <header>
      <div class="header-left">
        <img src="https://i.pinimg.com/736x/93/16/4b/93164be31e575e7697e242537393f51a.jpg" alt="angyfwen" class="pfp">
        <div>
          <div class="title-row">
            <h1>alis' web minigames</h1>
            <a href="https://github.com/angyfwen" target="_blank" rel="noopener noreferrer" class="github-link" title="github">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
              angyfwen
            </a>
          </div>
          <p class="status-text">mostly from internship projects... i guess... „Ç¥„Ç¥„Ç¥„Ç¥ or whatever</p>
        </div>
      </div>
      <div class="header-actions">
        <button id="music-toggle" class="preset" title="toggle bg music (ac 3pm)">üéµ</button>
        <button id="mode-toggle" class="preset" title="toggle dark / light">‚ú®</button>
      </div>
    </header>

    <div class="controls" role="region" aria-label="controls">
      <div class="controls-row">
        <div class="search-wrap" role="search">
          <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          <input id="search" placeholder="Search collection..." aria-label="search input"/>
        </div>
        
        <div class="preset-row" id="preset-row" aria-hidden="false">
          <!-- JS fills this -->
        </div>
      </div>
      
      <!-- GAME COMPATIBILITY WARNING (NEW) -->
      <div class="comp-warning">
        some games are not phone friendly! (‡∏á ‚Ä¢_‚Ä¢)‡∏á <br class="mobile-break"> computer is recommended for the chaos!
      </div>

    </div>

    <div class="grid" id="games-grid" role="list" aria-live="polite"></div>

    <footer id="footer-note"></footer>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal" role="dialog" aria-hidden="true">
    <div class="modal-panel" role="document">
      <div class="modal-header">
        <div style="display:flex; align-items:center; gap:10px">
          <span id="modal-title" class="modal-title">preview</span>
          <span id="modal-spinner" class="spinner" style="display:none; font-size:12px">loading...</span>
        </div>
        <div style="display:flex; gap:12px; align-items:center">
            <!-- Fixed "Open ‚Üó" button style -->
            <a id="modal-external" href="#" target="_blank" rel="noopener noreferrer" class="external-link-btn">
                open ‚Üó
            </a>
            <button class="close-btn" id="modal-close" title="Close">√ó</button>
        </div>
      </div>
      <iframe id="modal-iframe" title="game preview" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
    </div>
  </div>

<script>
const presetInfo = [
  {emoji:"üß∏", url:"https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExbmNsd3dseDN6dHI4aTExdnY4N3N0ajFyZXc1MWI5bGMycnZ0OG05YiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/dwAKRfxu3kxB12HFmW/giphy.gif"},
  {emoji:"ü•ä", url:"https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExNnI0OHBoaTg0NzcwaTR6aWdxYXZiODZjd2xwdTlpMHUyZ3h3MXFwayZlcD12MV9pbnRlcm55YWlfnaWZfYnlfaWQmY3Q9Zw/PamI2MtO1DU1a/giphy.gif"},
  {emoji:"üëæ", url:"https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExdG04cXFpYTVmYjNkcGRnMGUyenF1MTF4YzF2OWpudDR4ejNpNzI0MyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/z5kShzBAL5mM/giphy.gif"},
  {emoji:"üö¨", url:"https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExZnA3c2hzY214Nml4M3ZjbTJ5ZG5jMDl3ODNjbGJhZ211eDF5NGNzdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/LtVmxCRHQu33a/giphy.gif"},
  {emoji:"üç°", url:"https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExaTk5YWkwbDRoeDl6MHNqc2puY3c0aW9iNWJ0eDhjZjE1N2JkNnF6aiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/WfaHuht7D5SSNfetTf/giphy.gif"}
];

const games = [
  {id:"bio_war", url:"https://angyfwen.github.io/web-minigames/bio_war/", title:"bio war", desc:"microscopic chaos defend your viral core against quick enemy waves", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8.56 2.75c4.37 6.03 6.02 9.42 8.03 17.72m2.54-5.38C13.72 10.8 10.28 6.67 3.04 15.61"/></svg>`},
  {id:"burger_stack", url:"https://angyfwen.github.io/web-minigames/burger_stack/", title:"burger stack", desc:"precision stacking challenge pile the burger layers high without facepalming", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19.4 10.5C18.8 7.4 15.7 5 12 5s-6.8 2.4-7.4 5.5"/><path d="M4 14h16"/><path d="M4 10.5s0-3 8-3 8 3 8 3"/><path d="M4 18a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-4H4Z"/></svg>`},
  {id:"chem_balancer", url:"https://angyfwen.github.io/web-minigames/chem_balancer/", title:"chem balancer", desc:"tally the elements and fix the formula before the chaotic reaction", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 2v7.31"/><path d="M14 2v7.31"/><path d="M8.5 2h7"/><path d="M14 9.3a6.5 6.5 0 1 1-4 0"/><circle cx="10" cy="16" r="1"/><circle cx="14" cy="16" r="1"/></svg>`},
  {id:"code_breaker", url:"https://angyfwen.github.io/web-minigames/code_breaker/", title:"code breaker", desc:"crack the randomized 4-digit code using clever deductive logic", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>`},
  {id:"cosmic_sorter", url:"https://angyfwen.github.io/web-minigames/cosmic_sorter/", title:"cosmic sorter", desc:"become a tiny god sort incoming space debris by its color and size", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12c0 5.5 4.5 10 10 10s10-4.5 10-10S17.5 2 12 2 2 6.5 2 12z"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>`},
  {id:"logic_ambulance", url:"https://angyfwen.github.io/web-minigames/logic_ambulance/", title:"logic ambulance", desc:"a high-pressure rush of challenging logic and visual processing puzzles", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 2h4"/><path d="m21 7-3-3"/><path d="M3 7l3-3"/><circle cx="12" cy="14" r="8"/><path d="M12 10v4"/><path d="M12 18h.01"/></svg>`},
  {id:"orbit_architect", url:"https://angyfwen.github.io/web-minigames/orbit_architect/", title:"orbit architect", desc:"draw stable orbits for celestial bodies and avoid cosmic catastrophes", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L12 12l-6.74-6.74A9.75 9.75 0 0 1 12 3a9 9 0 0 1 9 9Z"/></svg>`},
  {id:"rythm_coder", url:"https://angyfwen.github.io/web-minigames/rythm_coder/", title:"rythm coder", desc:"test your speed and accuracy in this chaotic rhythm typing challenge", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>`},
  {id:"solar_ascent", url:"https://angyfwen.github.io/web-minigames/solar_ascent/", title:"solar ascent", desc:"launch your rocket dodge asteroids and battle the sun's intense gravity", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m4.5 16.5 4.5-4.5"/><path d="m9 12-4.5-4.5"/><path d="m19.5 7.5-4.5 4.5"/><path d="m15 12 4.5 4.5"/><circle cx="12" cy="12" r="2"/></svg>`},
  {id:"train_linker", url:"https://angyfwen.github.io/web-minigames/train_linker/", title:"train linker", desc:"connect railroad tracks quickly but strategically to guide the locomotive", icon:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="3" width="16" height="16" rx="2"/><path d="M4 11h16"/><path d="M12 3v8"/><path d="m8 19-2 3"/><path d="m16 19 2 3"/></svg>`}
];

/* SOUND ENGINE (Web Audio API & Files) */
const sfx = {
  ctx: null,
  clickAudio: null,
  
  init: function() {
    if(this.ctx) return;
    const Ctx = window.AudioContext || window.webkitAudioContext;
    if(Ctx) this.ctx = new Ctx();
    
    // Setup click sound from file - FIXED PATH for GitHub
    this.clickAudio = new Audio('audios/una.mp3');
    this.clickAudio.volume = 0.5;
    this.clickAudio.onerror = () => {
      console.warn("una.mp3 missing");
      this.clickAudio = null;
    };
  },
  play: function(type) {
    if(!this.ctx) this.init();
    if(!this.ctx || this.ctx.state === 'suspended') this.ctx?.resume();
    
    if (type === 'hover') {
      const osc = this.ctx.createOscillator();
      const gain = this.ctx.createGain();
      const now = this.ctx.currentTime;
      osc.connect(gain);
      gain.connect(this.ctx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(440, now);
      osc.frequency.exponentialRampToValueAtTime(800, now + 0.05);
      gain.gain.setValueAtTime(0.02, now);
      gain.gain.exponentialRampToValueAtTime(0.001, now + 0.05);
      osc.start(now);
      osc.stop(now + 0.06);
    } else if (type === 'click') {
      if (this.clickAudio) {
        this.clickAudio.currentTime = 0;
        this.clickAudio.play().catch(e => {
          this.clickAudio = null; // Disable faulty file
          this.play('click'); // Retry to hit synth fallback
        });
      } else {
         const osc = this.ctx.createOscillator();
         const gain = this.ctx.createGain();
         const now = this.ctx.currentTime;
         osc.connect(gain);
         gain.connect(this.ctx.destination);
         osc.type = 'triangle';
         osc.frequency.setValueAtTime(200, now);
         osc.frequency.exponentialRampToValueAtTime(50, now + 0.1);
         gain.gain.setValueAtTime(0.05, now);
         gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
         osc.start(now);
         osc.stop(now + 0.1);
      }
    } else if (type === 'chaos') {
      const osc = this.ctx.createOscillator();
      const gain = this.ctx.createGain();
      const now = this.ctx.currentTime;
      osc.connect(gain);
      gain.connect(this.ctx.destination);
      osc.type = 'sawtooth';
      osc.frequency.setValueAtTime(100, now);
      osc.frequency.linearRampToValueAtTime(1000, now + 0.3);
      osc.frequency.linearRampToValueAtTime(100, now + 0.6);
      gain.gain.setValueAtTime(0.1, now);
      gain.gain.linearRampToValueAtTime(0.001, now + 0.6);
      osc.start(now);
      osc.stop(now + 0.6);
    }
  }
};

/* MUSIC ENGINE - FIXED PATHS for GitHub */
const BG_MUSIC_URL = "audios/ac_3pm.mp3";
const JOJO_SFX_URL = "audios/oraoraora.mp3";
// Jojo background gif
const JOJO_BG_GIF = "https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjZobzNlampmZGM1dHJ5cXNhbThkNTVibzRsZmdkdTliOWs1NjNvbCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/TyFdAtfZBODNC/giphy.gif";

let bgAudio = new Audio(BG_MUSIC_URL);
bgAudio.loop = true;
bgAudio.volume = 0.3;
bgAudio.onerror = () => { 
  console.warn("BG Audio Missing"); 
  const btn = document.getElementById('music-toggle');
  if(btn) {
    btn.innerHTML = "üö´";
    btn.title = "missing audios/ac_3pm.mp3! check folder/filename";
    btn.style.opacity = "0.5";
  }
};

let jojoAudio = null;
let isBgPlaying = false;

// Background setting function
const bgImg = document.getElementById('bg-image');
function setBg(url){
  if(!url){ bgImg.style.opacity = '0'; return; }
  
  // 1. Fade OUT
  bgImg.style.opacity = '0';
  
  // 2. Wait for fade out to complete (matching the 0.6s CSS transition)
  setTimeout(() => {
    bgImg.src = url;
    // 3. Once new image is ready, fade IN
    bgImg.onload = () => { 
        // Always 0.4 opacity, regardless of mode (Hybrid Mode)
        bgImg.style.opacity = '0.4'; 
    };
  }, 600); 
}

// Randomize BG on first load
function setRandomBg() {
    const randomIdx = Math.floor(Math.random() * presetInfo.length);
    setBg(presetInfo[randomIdx].url);
}

// TOAST FUNCTION (No ugly alerts!)
function showToast(msg) {
    const container = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = 'toast';
    toast.textContent = msg;
    container.appendChild(toast);
    requestAnimationFrame(() => toast.classList.add('show'));
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

// Function to handle BG Music (AC 3PM)
function toggleBgMusic() {
  const btn = document.getElementById('music-toggle');
  sfx.init();

  if (isBgPlaying) {
    bgAudio.pause();
    isBgPlaying = false;
    btn.classList.remove('active');
    btn.style.opacity = "0.7";
  } else {
    // If jojo mode is active, don't play bg music yet, just set state
    if(document.body.classList.contains('chaos-mode')){
       isBgPlaying = true;
       btn.classList.add('active');
       return; 
    }
    
    // Try to play
    const promise = bgAudio.play();
    if(promise !== undefined) {
        promise.then(() => {
          isBgPlaying = true;
          btn.classList.add('active');
          btn.style.opacity = "1";
          btn.innerHTML = "üéµ"; 
        }).catch(e => {
          console.log("Audio play failed:", e);
          isBgPlaying = false; 
          if(e.name !== "NotAllowedError") {
             btn.innerHTML = "üö´";
             btn.title = "file issue: " + e.message;
          }
        });
    }
  }
}

// Function to handle Jojo Chaos Music
function playJojoMusic() {
  if (isBgPlaying && bgAudio) {
    bgAudio.pause();
  }

  if (!jojoAudio) {
    jojoAudio = new Audio(JOJO_SFX_URL);
    jojoAudio.loop = true; 
    jojoAudio.volume = 0.6;
    jojoAudio.onerror = () => { 
        console.warn("Jojo Audio Missing");
        jojoAudio = null; 
        showToast("missing audios/oraoraora.mp3! (T_T)"); 
    }; 
  }
  
  if (jojoAudio && jojoAudio.paused) {
    jojoAudio.currentTime = 0;
    jojoAudio.play().catch(e => {});
  }
}

function stopJojoMusic() {
  if (jojoAudio) {
    jojoAudio.pause();
    jojoAudio.currentTime = 0;
  }
  if (isBgPlaying && bgAudio) {
    bgAudio.play().catch(e => {});
  }
}

// Search Logic
function applyFilter() {
  const q = document.getElementById('search').value.toLowerCase();
  
  // Easter egg: Trigger chaos if 'jojo' is typed
  if (q === 'jojo') {
    if (!document.body.classList.contains('chaos-mode')) {
      document.body.classList.add('chaos-mode');
      playJojoMusic(); // Play music!
      setBg(JOJO_BG_GIF); // Set new BG
    }
  } else {
    // Only stop chaos if it was previously active
    if (document.body.classList.contains('chaos-mode')) {
      document.body.classList.remove('chaos-mode');
      stopJojoMusic(); // Stop music!
      // Restore original BG
      const savedPreset = localStorage.getItem('bgPreset');
      if(savedPreset !== null && presetInfo[savedPreset]){
          setBg(presetInfo[savedPreset].url);
      } else {
          setBg(presetInfo[0].url);
      }
    }
  }

  document.querySelectorAll('.card').forEach(card => {
    const text = card.textContent.toLowerCase();
    card.style.display = text.includes(q) ? 'flex' : 'none';
  });
}

// Favorites Logic
function getFavs(){ try { return JSON.parse(localStorage.getItem('wf_favs_v2')||'[]') } catch(e){ return [] } }
function isFav(id){ return getFavs().includes(id) }
function toggleFav(id, btn){
  const arr = getFavs();
  const i = arr.indexOf(id);
  const svg = btn.querySelector('svg');
  if(i === -1) {
    arr.push(id);
    btn.classList.add('hearted');
    svg.style.fill = "currentColor";
  } else {
    arr.splice(i,1);
    btn.classList.remove('hearted');
    svg.style.fill = "none";
  }
  localStorage.setItem('wf_favs_v2', JSON.stringify(arr));
}

// Modal Logic
const modal = document.getElementById('modal');
const iframe = document.getElementById('modal-iframe');
const spinner = document.getElementById('modal-spinner');
const externalLink = document.getElementById('modal-external'); 

function openPreview(id){
  sfx.play('click');
  const g = games.find(x => x.id === id);
  if(!g) return;
  
  document.getElementById('modal-title').textContent = g.title;
  externalLink.href = g.url; 
  
  spinner.style.display = 'block';
  iframe.src = '';
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
  setTimeout(() => {
    iframe.src = g.url;
    iframe.onload = () => spinner.style.display = 'none';
  }, 100);
}
document.getElementById('modal-close').addEventListener('click', () => {
  sfx.play('click');
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
  iframe.src = 'about:blank';
});
modal.addEventListener('click', (e) => { if(e.target === modal) document.getElementById('modal-close').click(); });

// Share Logic
function shareGame(id){
  const g = games.find(x => x.id === id);
  const url = g ? g.url : location.href;
  
  if(navigator.share) navigator.share({ title: g ? g.title : id, url });
  else {
    navigator.clipboard.writeText(url);
    showToast('Link copied to clipboard! (b ·µî‚ñΩ·µî)b');
  }
}

// Mouse Trail Logic
let lastTrailTime = 0;
document.addEventListener('mousemove', (e) => {
  const now = Date.now();
  if (now - lastTrailTime > 100) { 
    lastTrailTime = now;
    const el = document.createElement('div');
    el.className = 'menacing-trail';
    el.textContent = '„Ç¥';
    el.style.left = `${e.clientX}px`;
    el.style.top = `${e.clientY}px`;
    el.style.transform = `rotate(${Math.random() * 20 - 10}deg)`; 
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 1000);
  }
});

// Autoplay Logic
function tryAutoPlay() {
    const btn = document.getElementById('music-toggle');
    const promise = bgAudio.play();
    
    if(promise !== undefined){
        promise.then(() => {
            isBgPlaying = true;
            btn.classList.add('active');
            btn.style.opacity = "1";
        }).catch(error => {
            console.log("Autoplay prevented:", error);
            // Wait for any interaction to start music
            document.addEventListener('click', () => {
                if(!isBgPlaying && !document.body.classList.contains('chaos-mode')) {
                    bgAudio.play().then(() => {
                      isBgPlaying = true;
                      btn.classList.add('active');
                      btn.style.opacity = "1";
                      btn.innerHTML = "üéµ";
                    }).catch(e => {});
                }
            }, {once:true});
        });
    }
}

// Loader text update
function setLoaderReady() {
  const loader = document.getElementById('loader');
  const text = loader.querySelector('.loader-text');
  const sub = document.getElementById('loader-subtext');
  
  if (!loader || loader.style.display === 'none') return;
  
  setRandomBg();

  text.innerHTML = 'loading is done click anywhere!<br class="mobile-break"> (Ôæâ‚óï„ÉÆ‚óï)Ôæâ*:ÔΩ•Ôæü‚úß';
  sub.textContent = "click to unleash the chaos";
  
  document.addEventListener('click', () => {
      loader.style.opacity = '0';
      setTimeout(() => {
          loader.style.display = 'none';
          const btn = document.getElementById('music-toggle');
          if(!isBgPlaying && !document.body.classList.contains('chaos-mode')) {
             bgAudio.play().then(() => {
                isBgPlaying = true;
                btn.classList.add('active');
                btn.style.opacity = "1";
             }).catch(e => console.log(e));
          }
      }, 500);
  }, {once: true});
}

// --- MAIN INITIALIZATION ---
function initializeUI() {
    // 1. Music Button
    document.getElementById('music-toggle').addEventListener('click', toggleBgMusic);
    
    // 2. Search Input
    document.getElementById('search').addEventListener('input', applyFilter);

    // 3. Theme Toggle
    const modeToggle = document.getElementById('mode-toggle');
    modeToggle.addEventListener('mouseenter', () => sfx.play('hover'));
    modeToggle.addEventListener('click', () => {
      sfx.play('click');
      document.documentElement.classList.toggle('light');
      const isLight = document.documentElement.classList.contains('light');
      localStorage.setItem('siteMode', isLight ? 'light' : 'dark');
      modeToggle.textContent = isLight ? 'üåû' : '‚ú®';
      // Ensure BG stays visible
      if(bgImg.src) bgImg.style.opacity = '0.4'; 
    });

    // 4. Generate Presets
    const presetRow = document.getElementById('preset-row');
    presetInfo.forEach((p, i) => {
      const btn = document.createElement('button');
      btn.className = `preset`;
      btn.innerHTML = `<span aria-hidden="true">${p.emoji}</span>`;
      btn.title = `preset ${i+1}`;
      btn.addEventListener('click', ()=> { 
        sfx.play('click');
        setBg(p.url); 
        localStorage.setItem('bgPreset', i); 
      });
      btn.addEventListener('mouseenter', () => sfx.play('hover'));
      presetRow.appendChild(btn);
    });

    // 5. Render Grid
    const grid = document.getElementById('games-grid');
    games.forEach((g, index) => {
      const card = document.createElement('div'); 
      card.className = 'card';
      card.style.animationDelay = `${index * 0.05}s`;

      card.innerHTML = `
        <div class="top">
          <div class="icon-box" aria-hidden="true">${g.icon}</div>
          <div class="card-info">
            <h3>${g.title}</h3>
            <p>${g.desc}</p>
          </div>
        </div>

        <div class="thumb-wrap" role="img" aria-label="${g.title} thumbnail">
          <div class="fallback">
            <div style="width:24px; opacity:0.5">${g.icon}</div>
            <small style="font-size:10px; text-transform:uppercase; letter-spacing:1px">No Preview</small>
          </div>
        </div>

        <div class="actions">
          <a class="play-btn" href="${g.url}" target="_blank" rel="noopener">Play</a>
          <div class="secondary-actions">
            <button class="icon-btn preview-btn" title="Preview">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            </button>
            <button class="icon-btn fav-btn" data-id="${g.id}" title="Favorite">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
            </button>
            <button class="icon-btn share-btn" data-id="${g.id}" title="Share Link">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
            </button>
          </div>
        </div>
      `;
      grid.appendChild(card);

      // Card listeners
      card.addEventListener('mouseenter', () => sfx.play('hover'));
      const playBtn = card.querySelector('.play-btn');
      playBtn.addEventListener('mouseenter', (e) => { e.stopPropagation(); sfx.play('hover'); });
      playBtn.addEventListener('click', () => sfx.play('click'));
      
      card.querySelectorAll('.icon-btn').forEach(btn => {
        btn.addEventListener('mouseenter', (e) => { e.stopPropagation(); sfx.play('hover'); });
        btn.addEventListener('click', () => sfx.play('click'));
      });

      // Thumbnail logic
      const thumbWrap = card.querySelector('.thumb-wrap');
      const img = new Image();
      img.src = `https://image.thum.io/get/width/600/crop/800/noanimate/${g.url}`;
      img.alt = `${g.title} preview`;
      img.onload = () => {
        thumbWrap.innerHTML = '';
        thumbWrap.appendChild(img);
      };

      // Button logic
      card.querySelector('.preview-btn').addEventListener('click', () => openPreview(g.id));
      thumbWrap.addEventListener('click', () => openPreview(g.id));
      
      const favBtn = card.querySelector('.fav-btn');
      favBtn.addEventListener('click', (e) => { e.stopPropagation(); toggleFav(g.id, favBtn); });
      if(isFav(g.id)) {
         favBtn.classList.add('hearted');
         favBtn.querySelector('svg').style.fill = "currentColor";
      }

      card.querySelector('.share-btn').addEventListener('click', (e) => { e.stopPropagation(); shareGame(g.id); });
    });

    // 6. Set Footer Text (HERE IT IS!)
    document.getElementById('footer-note').textContent = "this is a FOOTer ;-; ‚Ä¢ tap emojis to summon cool bg gifs ‚Ä¢ too sleepy to explain, just click shit and scream ‚Ä¢ (psst: search 'jojo')";

    // 7. Initialize State (Theme)
    if(localStorage.getItem('siteMode') === 'light') {
      document.documentElement.classList.add('light');
      document.getElementById('mode-toggle').textContent = 'üåû';
    }
}

// DOM Loading Wrapper
window.onload = function() {
  
  initializeUI();
  
  // Set initial random BG
  setRandomBg();

  // Loader Setup
  const loadingJokes = [
    "summoning the chaos... ( Ôæâ ÔæüÔΩ∞Ôæü)Ôæâ",
    "i swear youre getting there just wait plz (¬¥„ÄÇÔºø„ÄÇÔΩÄ)",
    "downloading more ram... jk (¬¨‚Äø¬¨)",
    "convincing the browser to cooperate... (‡∏á ‚Ä¢_‚Ä¢)‡∏á",
    "loading pixels one by one... (‚î¨‚î¨Ôπè‚î¨‚î¨)",
    "making coffee for the server ‚òï ( ¬¥ÔΩ•ÔΩ•)Ôæâ(._.`)"
  ];
  document.getElementById('loader-subtext').textContent = loadingJokes[Math.floor(Math.random()*loadingJokes.length)];

  // Try to set loader to ready state
  setTimeout(setLoaderReady, 100); 
  
  // Safety switch
  setTimeout(setLoaderReady, 3000);
}

// Initialize audio context on first interaction
document.addEventListener('click', () => sfx.init(), {once:true});

</script>
</body>
</html>
